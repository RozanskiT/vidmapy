#!/usr/bin/env python3

from vidmapy.kurucz import models_grid
from vidmapy.kurucz import model

from unittest.mock import patch, mock_open, MagicMock

grid_text ="""TEFF   3500.  GRAVITY 0.00000 LTE 
TITLE  [-1.0] VTURB=2  L/H=1.25 NOVER NEW ODF                                   
 OPACITY IFOP 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 0 0 0 0
 CONVECTION ON   1.25 TURBULENCE OFF  0.00  0.00  0.00  0.00
ABUNDANCE SCALE   0.10000 ABUNDANCE CHANGE 1 0.92140 2 0.07843
 ABUNDANCE CHANGE  3 -10.94  4 -10.64  5  -9.49  6  -3.52  7  -4.12  8  -3.21
 ABUNDANCE CHANGE  9  -7.48 10  -3.96 11  -5.71 12  -4.46 13  -5.57 14  -4.49
 ABUNDANCE CHANGE 15  -6.59 16  -4.71 17  -6.54 18  -5.64 19  -6.92 20  -5.68
 ABUNDANCE CHANGE 21  -8.87 22  -7.02 23  -8.04 24  -6.37 25  -6.65 26  -4.54
 ABUNDANCE CHANGE 27  -7.12 28  -5.79 29  -7.83 30  -7.44 31  -9.16 32  -8.63
 ABUNDANCE CHANGE 33  -9.67 34  -8.63 35  -9.41 36  -8.73 37  -9.44 38  -9.07
 ABUNDANCE CHANGE 39  -9.80 40  -9.44 41 -10.62 42 -10.12 43 -20.00 44 -10.20
 ABUNDANCE CHANGE 45 -10.92 46 -10.35 47 -11.10 48 -10.27 49 -10.38 50 -10.04
 ABUNDANCE CHANGE 51 -11.04 52  -9.80 53 -10.53 54  -9.87 55 -10.91 56  -9.91
 ABUNDANCE CHANGE 57 -10.87 58 -10.46 59 -11.33 60 -10.54 61 -20.00 62 -11.03
 ABUNDANCE CHANGE 63 -11.53 64 -10.92 65 -11.69 66 -10.90 67 -11.78 68 -11.11
 ABUNDANCE CHANGE 69 -12.04 70 -10.96 71 -11.98 72 -11.16 73 -12.17 74 -10.93
 ABUNDANCE CHANGE 75 -11.76 76 -10.59 77 -10.69 78 -10.24 79 -11.03 80 -10.91
 ABUNDANCE CHANGE 81 -11.14 82 -10.09 83 -11.33 84 -20.00 85 -20.00 86 -20.00
 ABUNDANCE CHANGE 87 -20.00 88 -20.00 89 -20.00 90 -11.95 91 -20.00 92 -12.54
 ABUNDANCE CHANGE 93 -20.00 94 -20.00 95 -20.00 96 -20.00 97 -20.00 98 -20.00
 ABUNDANCE CHANGE 99 -20.00
READ DECK6 72 RHOX,T,P,XNE,ABROSS,ACCRAD,VTURB, FLXCNV,VCONV,VELSND
 1.23931103E-02   1995.0 1.239E-02 2.666E+04 1.076E-05 5.920E-04 2.000E+05 0.000E+00 0.000E+00 1.509E+06
 1.60273103E-02   1996.6 1.602E-02 3.351E+04 1.372E-05 6.322E-04 2.000E+05 0.000E+00 0.000E+00 1.263E+06
 2.01840484E-02   2009.4 2.017E-02 4.201E+04 1.482E-05 6.023E-04 2.000E+05 0.000E+00 0.000E+00 1.131E+06
 2.53652501E-02   2023.1 2.535E-02 5.263E+04 1.571E-05 5.723E-04 2.000E+05 0.000E+00 0.000E+00 1.021E+06
 3.19672952E-02   2038.4 3.195E-02 6.629E+04 1.624E-05 5.395E-04 2.000E+05 0.000E+00 0.000E+00 9.293E+05
 4.03968332E-02   2053.2 4.037E-02 8.357E+04 1.713E-05 5.052E-04 2.000E+05 0.000E+00 0.000E+00 8.456E+05
 5.11672742E-02   2070.1 5.114E-02 1.059E+05 1.761E-05 4.687E-04 2.000E+05 0.000E+00 0.000E+00 7.775E+05
 6.53611934E-02   2089.8 6.533E-02 1.358E+05 1.763E-05 4.296E-04 2.000E+05 0.000E+00 0.000E+00 7.213E+05
 8.37887693E-02   2107.0 8.375E-02 1.739E+05 1.857E-05 3.908E-04 2.000E+05 0.000E+00 0.000E+00 6.666E+05
 1.07311326E-01   2125.0 1.073E-01 2.227E+05 1.925E-05 3.550E-04 2.000E+05 0.000E+00 0.000E+00 6.219E+05
 1.37422045E-01   2142.8 1.374E-01 2.849E+05 2.015E-05 3.235E-04 2.000E+05 0.000E+00 0.000E+00 5.842E+05
 1.76058798E-01   2162.1 1.760E-01 3.653E+05 2.071E-05 2.950E-04 2.000E+05 0.000E+00 0.000E+00 5.545E+05
 2.26788094E-01   2183.6 2.267E-01 4.720E+05 2.087E-05 2.679E-04 2.000E+05 0.000E+00 0.000E+00 5.314E+05
 2.92913762E-01   2203.9 2.928E-01 6.099E+05 2.171E-05 2.427E-04 2.000E+05 0.000E+00 0.000E+00 5.109E+05
 3.76783053E-01   2222.5 3.767E-01 7.833E+05 2.301E-05 2.224E-04 2.000E+05 0.000E+00 0.000E+00 4.937E+05
 4.82351391E-01   2241.3 4.822E-01 1.002E+06 2.430E-05 2.055E-04 2.000E+05 0.000E+00 0.000E+00 4.807E+05
 6.16620470E-01   2261.3 6.164E-01 1.281E+06 2.528E-05 1.900E-04 2.000E+05 0.000E+00 0.000E+00 4.712E+05
 7.90546571E-01   2283.2 7.903E-01 1.648E+06 2.586E-05 1.747E-04 2.000E+05 0.000E+00 0.000E+00 4.647E+05
 1.01543460E+00   2304.4 1.015E+00 2.120E+06 2.697E-05 1.608E-04 2.000E+05 0.000E+00 0.000E+00 4.593E+05
 1.29689618E+00   2322.1 1.297E+00 2.699E+06 2.923E-05 1.521E-04 2.000E+05 0.000E+00 0.000E+00 4.541E+05
 1.64445918E+00   2340.3 1.644E+00 3.417E+06 3.135E-05 1.450E-04 2.000E+05 0.000E+00 0.000E+00 4.506E+05
 2.07925083E+00   2359.4 2.079E+00 4.320E+06 3.322E-05 1.381E-04 2.000E+05 0.000E+00 0.000E+00 4.485E+05
 2.63108213E+00   2380.2 2.631E+00 5.480E+06 3.467E-05 1.303E-04 2.000E+05 0.000E+00 0.000E+00 4.476E+05
 3.33812346E+00   2402.1 3.338E+00 6.979E+06 3.607E-05 1.221E-04 2.000E+05 0.000E+00 0.000E+00 4.474E+05
 4.21877403E+00   2419.4 4.218E+00 8.790E+06 3.967E-05 1.197E-04 2.000E+05 0.000E+00 0.000E+00 4.462E+05
 5.29128914E+00   2437.2 5.291E+00 1.101E+07 4.312E-05 1.175E-04 2.000E+05 0.000E+00 0.000E+00 4.457E+05
 6.61504572E+00   2456.1 6.614E+00 1.377E+07 4.632E-05 1.145E-04 2.000E+05 0.000E+00 0.000E+00 4.458E+05
 8.27040302E+00   2476.9 8.269E+00 1.727E+07 4.906E-05 1.099E-04 2.000E+05 0.000E+00 0.000E+00 4.466E+05
 1.03712346E+01   2499.7 1.037E+01 2.180E+07 5.134E-05 1.037E-04 2.000E+05 0.000E+00 0.000E+00 4.480E+05
 1.29998358E+01   2519.7 1.300E+01 2.737E+07 5.567E-05 1.018E-04 2.000E+05 0.000E+00 0.000E+00 4.487E+05
 1.62179627E+01   2538.9 1.622E+01 3.417E+07 6.086E-05 1.014E-04 2.000E+05 0.000E+00 0.000E+00 4.493E+05
 2.01673597E+01   2560.0 2.017E+01 4.268E+07 6.555E-05 9.934E-05 2.000E+05 0.000E+00 0.000E+00 4.505E+05
 2.50919817E+01   2583.4 2.509E+01 5.357E+07 6.963E-05 9.532E-05 2.000E+05 0.000E+00 0.000E+00 4.523E+05
 3.13402393E+01   2610.2 3.134E+01 6.792E+07 7.274E-05 8.873E-05 2.000E+05 0.000E+00 0.000E+00 4.549E+05
 3.91899552E+01   2634.1 3.919E+01 8.571E+07 7.845E-05 8.638E-05 2.000E+05 0.000E+00 0.000E+00 4.566E+05
 4.88204327E+01   2657.5 4.882E+01 1.077E+08 8.580E-05 8.633E-05 2.000E+05 0.000E+00 0.000E+00 4.583E+05
 6.06607907E+01   2684.2 6.065E+01 1.360E+08 9.198E-05 8.393E-05 2.000E+05 0.000E+00 0.000E+00 4.608E+05
 7.54922392E+01   2714.1 7.548E+01 1.733E+08 9.735E-05 7.975E-05 2.000E+05 0.000E+00 0.000E+00 4.639E+05
 9.43234389E+01   2747.9 9.431E+01 2.238E+08 1.018E-04 7.400E-05 2.000E+05 0.000E+00 0.000E+00 4.678E+05
 1.17858104E+02   2778.0 1.178E+02 2.866E+08 1.107E-04 7.351E-05 2.000E+05 0.000E+00 0.000E+00 4.708E+05
 1.46831111E+02   2811.1 1.468E+02 3.690E+08 1.191E-04 7.279E-05 2.000E+05 0.000E+00 0.000E+00 4.744E+05
 1.82957101E+02   2847.8 1.829E+02 4.799E+08 1.269E-04 7.121E-05 2.000E+05 0.000E+00 0.000E+00 4.787E+05
 2.28167475E+02   2886.4 2.281E+02 6.283E+08 1.355E-04 7.016E-05 2.000E+05 0.000E+00 0.000E+00 4.834E+05
 2.84015513E+02   2924.5 2.840E+02 8.206E+08 1.477E-04 7.245E-05 2.000E+05 0.000E+00 0.000E+00 4.879E+05
 3.52461321E+02   2964.3 3.524E+02 1.075E+09 1.602E-04 7.560E-05 2.000E+05 0.000E+00 0.000E+00 4.928E+05
 4.36517801E+02   3006.6 4.365E+02 1.415E+09 1.744E-04 8.041E-05 2.000E+05 0.000E+00 0.000E+00 4.982E+05
 5.38617616E+02   3053.6 5.386E+02 1.882E+09 1.930E-04 8.869E-05 2.000E+05 0.000E+00 0.000E+00 5.047E+05
 6.61699355E+02   3107.7 6.616E+02 2.547E+09 2.134E-04 9.979E-05 2.000E+05 0.000E+00 0.000E+00 5.128E+05
 8.09298404E+02   3172.2 8.092E+02 3.536E+09 2.388E-04 1.152E-04 2.000E+05 0.000E+00 0.000E+00 5.235E+05
 9.80758654E+02   3251.9 9.807E+02 5.066E+09 2.834E-04 1.403E-04 2.000E+05 0.000E+00 0.000E+00 5.380E+05
 1.16649905E+03   3347.1 1.166E+03 7.379E+09 3.614E-04 1.765E-04 2.000E+05 0.000E+00 0.000E+00 5.565E+05
 1.35307316E+03   3456.9 1.353E+03 1.068E+10 4.864E-04 2.259E-04 2.000E+05 0.000E+00 0.000E+00 5.780E+05
 1.54707752E+03   3570.3 1.547E+03 1.485E+10 6.009E-04 2.545E-04 2.000E+05 0.000E+00 0.000E+00 5.985E+05
 1.74956316E+03   3698.2 1.749E+03 2.013E+10 8.020E-04 3.086E-04 2.000E+05 0.000E+00 0.000E+00 6.192E+05
 1.94892368E+03   3832.9 1.949E+03 2.595E+10 1.080E-03 3.876E-04 2.000E+05 0.000E+00 0.000E+00 6.379E+05
 2.15930565E+03   3982.1 2.159E+03 3.237E+10 1.290E-03 4.253E-04 2.000E+05 0.000E+00 0.000E+00 6.558E+05
 2.39902614E+03   4140.9 2.399E+03 3.964E+10 1.492E-03 4.649E-04 2.000E+05 0.000E+00 0.000E+00 6.726E+05
 2.67150647E+03   4321.9 2.671E+03 5.092E+10 1.794E-03 5.317E-04 2.000E+05 9.180E-11 2.178E+02 6.897E+05
 2.95416791E+03   4517.8 2.953E+03 7.594E+10 2.505E-03 7.190E-04 2.000E+05 2.613E-08 1.409E+03 7.065E+05
 3.20128209E+03   4741.3 3.200E+03 1.397E+11 4.146E-03 1.152E-03 2.000E+05 2.633E-06 6.493E+03 7.242E+05
 3.38738166E+03   4990.8 3.386E+03 2.948E+11 7.740E-03 2.134E-03 2.000E+05 1.506E-04 2.494E+04 7.422E+05
 3.51527275E+03   5274.7 3.514E+03 6.743E+11 1.543E-02 4.272E-03 2.000E+05 2.348E-03 6.243E+04 7.602E+05
 3.59900806E+03   5596.3 3.597E+03 1.597E+12 3.183E-02 8.667E-03 2.000E+05 6.683E-03 8.805E+04 7.764E+05
 3.65321866E+03   5938.8 3.650E+03 3.644E+12 6.481E-02 1.558E-02 2.000E+05 9.459E-02 2.093E+05 7.875E+05
 3.69070807E+03   6246.8 3.687E+03 7.110E+12 1.179E-01 2.058E-02 2.000E+05 3.900E-01 3.387E+05 7.915E+05
 3.72045538E+03   6485.9 3.716E+03 1.145E+13 1.839E-01 2.073E-02 2.000E+05 6.148E-01 3.885E+05 7.918E+05
 3.74754332E+03   6668.4 3.743E+03 1.611E+13 2.560E-01 1.909E-02 2.000E+05 7.377E-01 3.999E+05 7.912E+05
 3.77418151E+03   6826.9 3.769E+03 2.137E+13 3.398E-01 1.808E-02 2.000E+05 8.156E-01 4.068E+05 7.906E+05
 3.80138088E+03   6970.1 3.796E+03 2.728E+13 4.373E-01 1.678E-02 2.000E+05 8.633E-01 4.022E+05 7.904E+05
 3.82999538E+03   7099.1 3.824E+03 3.372E+13 5.477E-01 1.587E-02 2.000E+05 8.995E-01 4.028E+05 7.906E+05
 3.86038646E+03   7229.7 3.854E+03 4.147E+13 6.867E-01 1.495E-02 2.000E+05 9.226E-01 3.944E+05 7.915E+05
 3.89320929E+03   7344.8 3.886E+03 4.949E+13 8.372E-01 1.505E-02 2.000E+05 9.369E-01 3.900E+05 7.928E+05
PRADK 1.9980E-01
BEGIN                    ITERATION  15 COMPLETED
TEFF   3500.  GRAVITY 0.50000 LTE 
TITLE  [-1.0] VTURB=2  L/H=1.25 NOVER NEW ODF                                   
 OPACITY IFOP 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 0 0 0 0
 CONVECTION ON   1.25 TURBULENCE OFF  0.00  0.00  0.00  0.00
ABUNDANCE SCALE   0.10000 ABUNDANCE CHANGE 1 0.92140 2 0.07843
 ABUNDANCE CHANGE  3 -10.94  4 -10.64  5  -9.49  6  -3.52  7  -4.12  8  -3.21
 ABUNDANCE CHANGE  9  -7.48 10  -3.96 11  -5.71 12  -4.46 13  -5.57 14  -4.49
 ABUNDANCE CHANGE 15  -6.59 16  -4.71 17  -6.54 18  -5.64 19  -6.92 20  -5.68
 ABUNDANCE CHANGE 21  -8.87 22  -7.02 23  -8.04 24  -6.37 25  -6.65 26  -4.54
 ABUNDANCE CHANGE 27  -7.12 28  -5.79 29  -7.83 30  -7.44 31  -9.16 32  -8.63
 ABUNDANCE CHANGE 33  -9.67 34  -8.63 35  -9.41 36  -8.73 37  -9.44 38  -9.07
 ABUNDANCE CHANGE 39  -9.80 40  -9.44 41 -10.62 42 -10.12 43 -20.00 44 -10.20
 ABUNDANCE CHANGE 45 -10.92 46 -10.35 47 -11.10 48 -10.27 49 -10.38 50 -10.04
 ABUNDANCE CHANGE 51 -11.04 52  -9.80 53 -10.53 54  -9.87 55 -10.91 56  -9.91
 ABUNDANCE CHANGE 57 -10.87 58 -10.46 59 -11.33 60 -10.54 61 -20.00 62 -11.03
 ABUNDANCE CHANGE 63 -11.53 64 -10.92 65 -11.69 66 -10.90 67 -11.78 68 -11.11
 ABUNDANCE CHANGE 69 -12.04 70 -10.96 71 -11.98 72 -11.16 73 -12.17 74 -10.93
 ABUNDANCE CHANGE 75 -11.76 76 -10.59 77 -10.69 78 -10.24 79 -11.03 80 -10.91
 ABUNDANCE CHANGE 81 -11.14 82 -10.09 83 -11.33 84 -20.00 85 -20.00 86 -20.00
 ABUNDANCE CHANGE 87 -20.00 88 -20.00 89 -20.00 90 -11.95 91 -20.00 92 -12.54
 ABUNDANCE CHANGE 93 -20.00 94 -20.00 95 -20.00 96 -20.00 97 -20.00 98 -20.00
 ABUNDANCE CHANGE 99 -20.00
READ DECK6 72 RHOX,T,P,XNE,ABROSS,ACCRAD,VTURB, FLXCNV,VCONV,VELSND
 7.42628859E-03   2007.4 2.348E-02 4.775E+04 1.796E-05 7.581E-04 2.000E+05 0.000E+00 0.000E+00 1.012E+06
 9.79905554E-03   2022.9 3.098E-02 6.264E+04 1.953E-05 7.363E-04 2.000E+05 0.000E+00 0.000E+00 8.947E+05
 1.26777641E-02   2036.0 4.008E-02 8.039E+04 2.167E-05 7.161E-04 2.000E+05 0.000E+00 0.000E+00 7.994E+05
 1.61862431E-02   2050.0 5.117E-02 1.021E+05 2.341E-05 6.921E-04 2.000E+05 0.000E+00 0.000E+00 7.273E+05
 2.05701487E-02   2065.8 6.503E-02 1.296E+05 2.455E-05 6.639E-04 2.000E+05 0.000E+00 0.000E+00 6.716E+05
 2.62602065E-02   2084.3 8.302E-02 1.660E+05 2.488E-05 6.298E-04 2.000E+05 0.000E+00 0.000E+00 6.277E+05
 3.36096983E-02   2100.9 1.063E-01 2.121E+05 2.623E-05 5.922E-04 2.000E+05 0.000E+00 0.000E+00 5.868E+05
 4.27773446E-02   2115.8 1.352E-01 2.688E+05 2.833E-05 5.545E-04 2.000E+05 0.000E+00 0.000E+00 5.519E+05
 5.42144980E-02   2132.2 1.714E-01 3.401E+05 2.984E-05 5.160E-04 2.000E+05 0.000E+00 0.000E+00 5.255E+05
 6.88693474E-02   2150.4 2.177E-01 4.324E+05 3.071E-05 4.768E-04 2.000E+05 0.000E+00 0.000E+00 5.053E+05
 8.81497813E-02   2171.3 2.787E-01 5.556E+05 3.081E-05 4.363E-04 2.000E+05 0.000E+00 0.000E+00 4.900E+05
 1.13656675E-01   2192.5 3.594E-01 7.183E+05 3.130E-05 3.969E-04 2.000E+05 0.000E+00 0.000E+00 4.770E+05
 1.46206211E-01   2210.5 4.623E-01 9.218E+05 3.350E-05 3.632E-04 2.000E+05 0.000E+00 0.000E+00 4.650E+05
 1.87051208E-01   2229.5 5.914E-01 1.178E+06 3.523E-05 3.341E-04 2.000E+05 0.000E+00 0.000E+00 4.565E+05
 2.39266191E-01   2249.7 7.565E-01 1.509E+06 3.647E-05 3.079E-04 2.000E+05 0.000E+00 0.000E+00 4.506E+05
 3.07274598E-01   2272.0 9.716E-01 1.944E+06 3.708E-05 2.824E-04 2.000E+05 0.000E+00 0.000E+00 4.469E+05
 3.95600993E-01   2293.2 1.251E+00 2.505E+06 3.858E-05 2.602E-04 2.000E+05 0.000E+00 0.000E+00 4.437E+05
 5.06464319E-01   2311.6 1.601E+00 3.198E+06 4.166E-05 2.437E-04 2.000E+05 0.000E+00 0.000E+00 4.406E+05
 6.43934061E-01   2330.3 2.036E+00 4.060E+06 4.448E-05 2.300E-04 2.000E+05 0.000E+00 0.000E+00 4.387E+05
 8.16641149E-01   2349.9 2.582E+00 5.147E+06 4.697E-05 2.174E-04 2.000E+05 0.000E+00 0.000E+00 4.378E+05
 1.03591075E+00   2370.4 3.276E+00 6.535E+06 4.923E-05 2.053E-04 2.000E+05 0.000E+00 0.000E+00 4.376E+05
 1.31197630E+00   2389.3 4.148E+00 8.264E+06 5.266E-05 1.973E-04 2.000E+05 0.000E+00 0.000E+00 4.373E+05
 1.65461060E+00   2408.0 5.232E+00 1.041E+07 5.681E-05 1.907E-04 2.000E+05 0.000E+00 0.000E+00 4.372E+05
 2.07491261E+00   2425.0 6.561E+00 1.300E+07 6.220E-05 1.880E-04 2.000E+05 0.000E+00 0.000E+00 4.371E+05
 2.58864335E+00   2442.7 8.185E+00 1.619E+07 6.743E-05 1.851E-04 2.000E+05 0.000E+00 0.000E+00 4.373E+05
 3.22515770E+00   2461.4 1.020E+01 2.016E+07 7.232E-05 1.807E-04 2.000E+05 0.000E+00 0.000E+00 4.380E+05
 4.00453503E+00   2476.7 1.266E+01 2.489E+07 7.988E-05 1.834E-04 2.000E+05 0.000E+00 0.000E+00 4.379E+05
 4.95266177E+00   2494.3 1.566E+01 3.074E+07 8.660E-05 1.828E-04 2.000E+05 0.000E+00 0.000E+00 4.385E+05
 6.13025857E+00   2514.7 1.938E+01 3.814E+07 9.252E-05 1.780E-04 2.000E+05 0.000E+00 0.000E+00 4.398E+05
 7.57509179E+00   2531.6 2.395E+01 4.699E+07 1.022E-04 1.808E-04 2.000E+05 0.000E+00 0.000E+00 4.403E+05
 9.33958963E+00   2550.8 2.953E+01 5.799E+07 1.104E-04 1.791E-04 2.000E+05 0.000E+00 0.000E+00 4.414E+05
 1.15021151E+01   2568.1 3.637E+01 7.125E+07 1.209E-04 1.812E-04 2.000E+05 0.000E+00 0.000E+00 4.420E+05
 1.41410229E+01   2586.6 4.472E+01 8.757E+07 1.314E-04 1.820E-04 2.000E+05 0.000E+00 0.000E+00 4.429E+05
 1.74123806E+01   2609.1 5.506E+01 1.085E+08 1.400E-04 1.768E-04 2.000E+05 0.000E+00 0.000E+00 4.447E+05
 2.15313431E+01   2635.0 6.808E+01 1.357E+08 1.480E-04 1.681E-04 2.000E+05 0.000E+00 0.000E+00 4.472E+05
 2.66534475E+01   2658.0 8.428E+01 1.690E+08 1.609E-04 1.666E-04 2.000E+05 0.000E+00 0.000E+00 4.489E+05
 3.30063482E+01   2684.4 1.044E+02 2.118E+08 1.712E-04 1.597E-04 2.000E+05 0.000E+00 0.000E+00 4.513E+05
 4.09235930E+01   2709.8 1.294E+02 2.653E+08 1.841E-04 1.559E-04 2.000E+05 0.000E+00 0.000E+00 4.534E+05
 5.08285610E+01   2740.7 1.607E+02 3.365E+08 1.946E-04 1.471E-04 2.000E+05 0.000E+00 0.000E+00 4.566E+05
 6.32416405E+01   2772.5 2.000E+02 4.283E+08 2.084E-04 1.414E-04 2.000E+05 0.000E+00 0.000E+00 4.599E+05
 7.86870793E+01   2805.8 2.488E+02 5.475E+08 2.230E-04 1.363E-04 2.000E+05 0.000E+00 0.000E+00 4.634E+05
 9.80437442E+01   2842.6 3.100E+02 7.066E+08 2.366E-04 1.293E-04 2.000E+05 0.000E+00 0.000E+00 4.676E+05
 1.22242152E+02   2878.7 3.865E+02 9.119E+08 2.537E-04 1.259E-04 2.000E+05 0.000E+00 0.000E+00 4.715E+05
 1.52159811E+02   2916.2 4.811E+02 1.180E+09 2.751E-04 1.269E-04 2.000E+05 0.000E+00 0.000E+00 4.756E+05
 1.88980678E+02   2956.1 5.976E+02 1.535E+09 2.974E-04 1.288E-04 2.000E+05 0.000E+00 0.000E+00 4.802E+05
 2.34378251E+02   2997.5 7.411E+02 2.004E+09 3.220E-04 1.324E-04 2.000E+05 0.000E+00 0.000E+00 4.850E+05
 2.90097878E+02   3041.3 9.173E+02 2.629E+09 3.508E-04 1.401E-04 2.000E+05 0.000E+00 0.000E+00 4.902E+05
 3.58351783E+02   3089.7 1.133E+03 3.488E+09 3.813E-04 1.526E-04 2.000E+05 0.000E+00 0.000E+00 4.964E+05
 4.42201082E+02   3146.4 1.398E+03 4.731E+09 4.142E-04 1.701E-04 2.000E+05 0.000E+00 0.000E+00 5.043E+05
 5.43872899E+02   3216.6 1.720E+03 6.644E+09 4.624E-04 1.994E-04 2.000E+05 0.000E+00 0.000E+00 5.152E+05
 6.63388057E+02   3304.5 2.098E+03 9.705E+09 5.344E-04 2.434E-04 2.000E+05 0.000E+00 0.000E+00 5.303E+05
 7.93717733E+02   3415.1 2.510E+03 1.467E+10 6.865E-04 3.160E-04 2.000E+05 0.000E+00 0.000E+00 5.511E+05
 9.29372407E+02   3536.5 2.939E+03 2.180E+10 8.772E-04 3.843E-04 2.000E+05 0.000E+00 0.000E+00 5.746E+05
 1.06657272E+03   3671.9 3.373E+03 3.148E+10 1.201E-03 4.728E-04 2.000E+05 0.000E+00 0.000E+00 5.999E+05
 1.19499370E+03   3813.3 3.779E+03 4.274E+10 1.720E-03 6.289E-04 2.000E+05 2.477E-10 2.460E+02 6.238E+05
 1.32399859E+03   3967.3 4.186E+03 5.542E+10 2.145E-03 7.139E-04 2.000E+05 5.190E-10 3.156E+02 6.471E+05
 1.46632174E+03   4128.5 4.636E+03 6.925E+10 2.542E-03 7.957E-04 2.000E+05 1.166E-09 4.100E+02 6.660E+05
 1.62689097E+03   4312.7 5.144E+03 8.741E+10 3.002E-03 8.914E-04 2.000E+05 6.069E-09 7.028E+02 6.856E+05
 1.80133169E+03   4509.4 5.695E+03 1.212E+11 3.905E-03 1.123E-03 2.000E+05 2.150E-07 2.276E+03 7.040E+05
 1.96566209E+03   4735.8 6.215E+03 2.079E+11 6.044E-03 1.685E-03 2.000E+05 1.427E-05 9.127E+03 7.230E+05
 2.09625373E+03   4985.4 6.628E+03 4.211E+11 1.085E-02 2.992E-03 2.000E+05 7.197E-04 3.356E+04 7.419E+05
 2.18822150E+03   5271.2 6.918E+03 9.512E+11 2.134E-02 5.870E-03 2.000E+05 6.939E-03 7.156E+04 7.613E+05
 2.24936433E+03   5589.3 7.111E+03 2.219E+12 4.314E-02 1.129E-02 2.000E+05 2.768E-02 1.125E+05 7.794E+05
 2.29050167E+03   5909.5 7.240E+03 4.817E+12 8.308E-02 1.804E-02 2.000E+05 2.020E-01 2.186E+05 7.929E+05
 2.32087295E+03   6184.3 7.336E+03 8.829E+12 1.407E-01 2.134E-02 2.000E+05 4.789E-01 2.957E+05 8.001E+05
 2.34649874E+03   6400.3 7.416E+03 1.374E+13 2.092E-01 2.123E-02 2.000E+05 6.484E-01 3.220E+05 8.031E+05
 2.37050753E+03   6578.2 7.492E+03 1.937E+13 2.872E-01 2.035E-02 2.000E+05 7.508E-01 3.316E+05 8.041E+05
 2.39431669E+03   6737.7 7.567E+03 2.598E+13 3.796E-01 1.975E-02 2.000E+05 8.193E-01 3.373E+05 8.043E+05
 2.41866115E+03   6885.0 7.643E+03 3.368E+13 4.890E-01 1.878E-02 2.000E+05 8.632E-01 3.347E+05 8.043E+05
 2.44419407E+03   7020.5 7.723E+03 4.238E+13 6.153E-01 1.812E-02 2.000E+05 8.978E-01 3.359E+05 8.042E+05
 2.47120118E+03   7158.0 7.808E+03 5.305E+13 7.748E-01 1.734E-02 2.000E+05 9.205E-01 3.295E+05 8.043E+05
 2.50018754E+03   7280.9 7.899E+03 6.444E+13 9.508E-01 1.774E-02 2.000E+05 9.345E-01 3.260E+05 8.048E+05
PRADK 2.0005E-01
BEGIN                    ITERATION  15 COMPLETED
TEFF   3500.  GRAVITY 1.00000 LTE 
TITLE  [-1.0] VTURB=2  L/H=1.25 NOVER NEW ODF                                   
 OPACITY IFOP 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 0 0 0 0
 CONVECTION ON   1.25 TURBULENCE OFF  0.00  0.00  0.00  0.00
ABUNDANCE SCALE   0.10000 ABUNDANCE CHANGE 1 0.92140 2 0.07843
 ABUNDANCE CHANGE  3 -10.94  4 -10.64  5  -9.49  6  -3.52  7  -4.12  8  -3.21
 ABUNDANCE CHANGE  9  -7.48 10  -3.96 11  -5.71 12  -4.46 13  -5.57 14  -4.49
 ABUNDANCE CHANGE 15  -6.59 16  -4.71 17  -6.54 18  -5.64 19  -6.92 20  -5.68
 ABUNDANCE CHANGE 21  -8.87 22  -7.02 23  -8.04 24  -6.37 25  -6.65 26  -4.54
 ABUNDANCE CHANGE 27  -7.12 28  -5.79 29  -7.83 30  -7.44 31  -9.16 32  -8.63
 ABUNDANCE CHANGE 33  -9.67 34  -8.63 35  -9.41 36  -8.73 37  -9.44 38  -9.07
 ABUNDANCE CHANGE 39  -9.80 40  -9.44 41 -10.62 42 -10.12 43 -20.00 44 -10.20
 ABUNDANCE CHANGE 45 -10.92 46 -10.35 47 -11.10 48 -10.27 49 -10.38 50 -10.04
 ABUNDANCE CHANGE 51 -11.04 52  -9.80 53 -10.53 54  -9.87 55 -10.91 56  -9.91
 ABUNDANCE CHANGE 57 -10.87 58 -10.46 59 -11.33 60 -10.54 61 -20.00 62 -11.03
 ABUNDANCE CHANGE 63 -11.53 64 -10.92 65 -11.69 66 -10.90 67 -11.78 68 -11.11
 ABUNDANCE CHANGE 69 -12.04 70 -10.96 71 -11.98 72 -11.16 73 -12.17 74 -10.93
 ABUNDANCE CHANGE 75 -11.76 76 -10.59 77 -10.69 78 -10.24 79 -11.03 80 -10.91
 ABUNDANCE CHANGE 81 -11.14 82 -10.09 83 -11.33 84 -20.00 85 -20.00 86 -20.00
 ABUNDANCE CHANGE 87 -20.00 88 -20.00 89 -20.00 90 -11.95 91 -20.00 92 -12.54
 ABUNDANCE CHANGE 93 -20.00 94 -20.00 95 -20.00 96 -20.00 97 -20.00 98 -20.00
 ABUNDANCE CHANGE 99 -20.00
READ DECK6 72 RHOX,T,P,XNE,ABROSS,ACCRAD,VTURB, FLXCNV,VCONV,VELSND
 5.01308376E-03   2039.9 5.013E-02 9.831E+04 2.660E-05 8.452E-04 2.000E+05 0.000E+00 0.000E+00 7.119E+05
 6.60765023E-03   2055.6 6.607E-02 1.288E+05 2.918E-05 8.330E-04 2.000E+05 0.000E+00 0.000E+00 6.461E+05
 8.57768395E-03   2072.1 8.577E-02 1.667E+05 3.103E-05 8.192E-04 2.000E+05 0.000E+00 0.000E+00 5.980E+05
 1.10697761E-02   2089.5 1.107E-01 2.151E+05 3.244E-05 8.002E-04 2.000E+05 0.000E+00 0.000E+00 5.609E+05
 1.41253992E-02   2101.7 1.412E-01 2.718E+05 3.659E-05 7.808E-04 2.000E+05 0.000E+00 0.000E+00 5.266E+05
 1.77867628E-02   2114.9 1.779E-01 3.402E+05 4.002E-05 7.570E-04 2.000E+05 0.000E+00 0.000E+00 5.020E+05
 2.23049205E-02   2129.3 2.230E-01 4.251E+05 4.277E-05 7.297E-04 2.000E+05 0.000E+00 0.000E+00 4.836E+05
 2.80229771E-02   2145.6 2.802E-01 5.338E+05 4.458E-05 6.973E-04 2.000E+05 0.000E+00 0.000E+00 4.699E+05
 3.53589082E-02   2162.7 3.536E-01 6.733E+05 4.625E-05 6.622E-04 2.000E+05 0.000E+00 0.000E+00 4.588E+05
 4.48212224E-02   2181.0 4.482E-01 8.543E+05 4.775E-05 6.226E-04 2.000E+05 0.000E+00 0.000E+00 4.503E+05
 5.69209581E-02   2198.8 5.692E-01 1.084E+06 5.028E-05 5.816E-04 2.000E+05 0.000E+00 0.000E+00 4.433E+05
 7.22126706E-02   2216.5 7.221E-01 1.374E+06 5.305E-05 5.422E-04 2.000E+05 0.000E+00 0.000E+00 4.379E+05
 9.17796307E-02   2236.1 9.177E-01 1.748E+06 5.475E-05 5.021E-04 2.000E+05 0.000E+00 0.000E+00 4.345E+05
 1.16958641E-01   2255.3 1.170E+00 2.228E+06 5.696E-05 4.670E-04 2.000E+05 0.000E+00 0.000E+00 4.318E+05
 1.49263428E-01   2275.5 1.493E+00 2.846E+06 5.906E-05 4.334E-04 2.000E+05 0.000E+00 0.000E+00 4.302E+05
 1.90863053E-01   2296.9 1.909E+00 3.647E+06 6.118E-05 4.002E-04 2.000E+05 0.000E+00 0.000E+00 4.296E+05
 2.43610380E-01   2315.9 2.436E+00 4.646E+06 6.528E-05 3.756E-04 2.000E+05 0.000E+00 0.000E+00 4.287E+05
 3.10031503E-01   2336.0 3.100E+00 5.912E+06 6.864E-05 3.524E-04 2.000E+05 0.000E+00 0.000E+00 4.286E+05
 3.93147241E-01   2353.2 3.931E+00 7.465E+06 7.407E-05 3.395E-04 2.000E+05 0.000E+00 0.000E+00 4.281E+05
 4.96125549E-01   2371.5 4.961E+00 9.399E+06 7.925E-05 3.271E-04 2.000E+05 0.000E+00 0.000E+00 4.282E+05
 6.25787411E-01   2392.2 6.258E+00 1.187E+07 8.343E-05 3.108E-04 2.000E+05 0.000E+00 0.000E+00 4.292E+05
 7.87877344E-01   2410.9 7.878E+00 1.492E+07 9.011E-05 3.011E-04 2.000E+05 0.000E+00 0.000E+00 4.297E+05
 9.87173414E-01   2428.5 9.871E+00 1.863E+07 9.810E-05 2.955E-04 2.000E+05 0.000E+00 0.000E+00 4.302E+05
 1.22718202E+00   2441.4 1.227E+01 2.295E+07 1.103E-04 3.043E-04 2.000E+05 0.000E+00 0.000E+00 4.297E+05
 1.51250778E+00   2454.7 1.512E+01 2.806E+07 1.231E-04 3.142E-04 2.000E+05 0.000E+00 0.000E+00 4.295E+05
 1.85531933E+00   2469.1 1.855E+01 3.422E+07 1.359E-04 3.217E-04 2.000E+05 0.000E+00 0.000E+00 4.297E+05
 2.27237673E+00   2485.6 2.272E+01 4.181E+07 1.479E-04 3.245E-04 2.000E+05 0.000E+00 0.000E+00 4.304E+05
 2.79136457E+00   2506.1 2.791E+01 5.151E+07 1.569E-04 3.159E-04 2.000E+05 0.000E+00 0.000E+00 4.319E+05
 3.42900502E+00   2520.9 3.429E+01 6.290E+07 1.746E-04 3.263E-04 2.000E+05 0.000E+00 0.000E+00 4.322E+05
 4.18070467E+00   2531.0 4.181E+01 7.578E+07 1.996E-04 3.538E-04 2.000E+05 0.000E+00 0.000E+00 4.315E+05
 5.06871529E+00   2544.0 5.069E+01 9.121E+07 2.217E-04 3.722E-04 2.000E+05 0.000E+00 0.000E+00 4.315E+05
 6.14708662E+00   2560.0 6.147E+01 1.103E+08 2.410E-04 3.800E-04 2.000E+05 0.000E+00 0.000E+00 4.322E+05
 7.48315094E+00   2579.6 7.483E+01 1.345E+08 2.571E-04 3.763E-04 2.000E+05 0.000E+00 0.000E+00 4.336E+05
 9.17064107E+00   2603.8 9.170E+01 1.661E+08 2.694E-04 3.597E-04 2.000E+05 0.000E+00 0.000E+00 4.358E+05
 1.13228134E+01   2629.5 1.132E+02 2.070E+08 2.818E-04 3.403E-04 2.000E+05 0.000E+00 0.000E+00 4.381E+05
 1.39937408E+01   2647.5 1.399E+02 2.550E+08 3.105E-04 3.504E-04 2.000E+05 0.000E+00 0.000E+00 4.388E+05
 1.72868212E+01   2672.2 1.729E+02 3.171E+08 3.288E-04 3.396E-04 2.000E+05 0.000E+00 0.000E+00 4.408E+05
 2.14548196E+01   2701.1 2.145E+02 3.987E+08 3.453E-04 3.207E-04 2.000E+05 0.000E+00 0.000E+00 4.436E+05
 2.67587646E+01   2734.4 2.676E+02 5.069E+08 3.619E-04 2.971E-04 2.000E+05 0.000E+00 0.000E+00 4.471E+05
 3.34767545E+01   2768.2 3.348E+02 6.472E+08 3.827E-04 2.781E-04 2.000E+05 0.000E+00 0.000E+00 4.506E+05
 4.19079535E+01   2799.6 4.191E+02 8.238E+08 4.083E-04 2.665E-04 2.000E+05 0.000E+00 0.000E+00 4.536E+05
 5.24948956E+01   2836.7 5.249E+02 1.061E+09 4.319E-04 2.499E-04 2.000E+05 0.000E+00 0.000E+00 4.575E+05
 6.57629655E+01   2876.0 6.576E+02 1.373E+09 4.621E-04 2.372E-04 2.000E+05 0.000E+00 0.000E+00 4.619E+05
 8.22126255E+01   2915.4 8.221E+02 1.777E+09 4.995E-04 2.317E-04 2.000E+05 0.000E+00 0.000E+00 4.661E+05
 1.02521664E+02   2956.2 1.025E+03 2.306E+09 5.383E-04 2.277E-04 2.000E+05 0.000E+00 0.000E+00 4.706E+05
 1.27651613E+02   2997.3 1.276E+03 2.994E+09 5.810E-04 2.285E-04 2.000E+05 0.000E+00 0.000E+00 4.751E+05
 1.58534580E+02   3040.7 1.585E+03 3.903E+09 6.336E-04 2.369E-04 2.000E+05 0.000E+00 0.000E+00 4.799E+05
 1.96278663E+02   3087.2 1.963E+03 5.120E+09 6.904E-04 2.512E-04 2.000E+05 0.000E+00 0.000E+00 4.853E+05
 2.42557674E+02   3139.0 2.426E+03 6.801E+09 7.496E-04 2.709E-04 2.000E+05 0.000E+00 0.000E+00 4.917E+05
 2.99424822E+02   3200.2 2.994E+03 9.256E+09 8.138E-04 3.025E-04 2.000E+05 0.000E+00 0.000E+00 4.998E+05
 3.69126213E+02   3276.1 3.691E+03 1.309E+10 8.880E-04 3.529E-04 2.000E+05 0.000E+00 0.000E+00 5.109E+05
 4.51814779E+02   3376.3 4.518E+03 1.958E+10 1.036E-03 4.422E-04 2.000E+05 8.596E-10 2.659E+02 5.271E+05
 5.43520996E+02   3500.9 5.435E+03 3.039E+10 1.283E-03 5.654E-04 2.000E+05 1.426E-08 6.896E+02 5.493E+05
 6.38527703E+02   3642.2 6.385E+03 4.664E+10 1.725E-03 6.998E-04 2.000E+05 3.745E-08 9.760E+02 5.758E+05
 7.24756557E+02   3792.5 7.247E+03 6.746E+10 2.625E-03 9.793E-04 2.000E+05 1.271E-07 1.506E+03 6.040E+05
 8.06795177E+02   3952.2 8.068E+03 9.182E+10 3.468E-03 1.173E-03 2.000E+05 1.786E-07 1.717E+03 6.314E+05
 8.92929199E+02   4117.3 8.929E+03 1.185E+11 4.266E-03 1.348E-03 2.000E+05 2.631E-07 1.965E+03 6.556E+05
 9.88039387E+02   4304.8 9.880E+03 1.507E+11 5.087E-03 1.517E-03 2.000E+05 4.500E-07 2.346E+03 6.789E+05
 1.09292559E+03   4503.0 1.093E+04 1.998E+11 6.315E-03 1.823E-03 2.000E+05 3.108E-06 4.430E+03 6.998E+05
 1.19840719E+03   4731.7 1.198E+04 3.174E+11 9.074E-03 2.538E-03 2.000E+05 9.153E-05 1.357E+04 7.207E+05
 1.28787836E+03   4982.0 1.288E+04 6.106E+11 1.551E-02 4.263E-03 2.000E+05 3.208E-03 4.417E+04 7.410E+05
 1.35310582E+03   5268.2 1.353E+04 1.347E+12 2.975E-02 7.991E-03 2.000E+05 2.076E-02 8.221E+04 7.616E+05
 1.39792675E+03   5572.0 1.398E+04 3.006E+12 5.759E-02 1.394E-02 2.000E+05 9.650E-02 1.365E+05 7.806E+05
 1.42984604E+03   5861.6 1.430E+04 6.092E+12 1.036E-01 1.959E-02 2.000E+05 3.261E-01 2.080E+05 7.954E+05
 1.45510003E+03   6103.1 1.455E+04 1.050E+13 1.642E-01 2.152E-02 2.000E+05 5.480E-01 2.488E+05 8.049E+05
 1.47747780E+03   6301.9 1.477E+04 1.598E+13 2.362E-01 2.165E-02 2.000E+05 6.802E-01 2.644E+05 8.105E+05
 1.49887535E+03   6475.0 1.498E+04 2.260E+13 3.208E-01 2.135E-02 2.000E+05 7.660E-01 2.719E+05 8.140E+05
 1.52025111E+03   6633.9 1.520E+04 3.062E+13 4.221E-01 2.114E-02 2.000E+05 8.256E-01 2.766E+05 8.161E+05
 1.54213384E+03   6784.5 1.542E+04 4.033E+13 5.446E-01 2.061E-02 2.000E+05 8.655E-01 2.755E+05 8.173E+05
 1.56501286E+03   6925.1 1.564E+04 5.166E+13 6.882E-01 2.025E-02 2.000E+05 8.978E-01 2.769E+05 8.180E+05
 1.58911907E+03   7068.7 1.589E+04 6.586E+13 8.704E-01 1.974E-02 2.000E+05 9.195E-01 2.727E+05 8.184E+05
 1.61482569E+03   7199.1 1.614E+04 8.155E+13 1.075E+00 2.054E-02 2.000E+05 9.329E-01 2.702E+05 8.188E+05
PRADK 2.0030E-01
BEGIN                    ITERATION  15 COMPLETED
TEFF   3500.  GRAVITY 1.50000 LTE 
TITLE  [-1.0] VTURB=2  L/H=1.25 NOVER NEW ODF                                   
 OPACITY IFOP 1 1 1 1 1 1 1 1 1 1 1 1 1 0 1 0 0 0 0 0
 CONVECTION ON   1.25 TURBULENCE OFF  0.00  0.00  0.00  0.00
ABUNDANCE SCALE   0.10000 ABUNDANCE CHANGE 1 0.92140 2 0.07843
 ABUNDANCE CHANGE  3 -10.94  4 -10.64  5  -9.49  6  -3.52  7  -4.12  8  -3.21
 ABUNDANCE CHANGE  9  -7.48 10  -3.96 11  -5.71 12  -4.46 13  -5.57 14  -4.49
 ABUNDANCE CHANGE 15  -6.59 16  -4.71 17  -6.54 18  -5.64 19  -6.92 20  -5.68
 ABUNDANCE CHANGE 21  -8.87 22  -7.02 23  -8.04 24  -6.37 25  -6.65 26  -4.54
 ABUNDANCE CHANGE 27  -7.12 28  -5.79 29  -7.83 30  -7.44 31  -9.16 32  -8.63
 ABUNDANCE CHANGE 33  -9.67 34  -8.63 35  -9.41 36  -8.73 37  -9.44 38  -9.07
 ABUNDANCE CHANGE 39  -9.80 40  -9.44 41 -10.62 42 -10.12 43 -20.00 44 -10.20
 ABUNDANCE CHANGE 45 -10.92 46 -10.35 47 -11.10 48 -10.27 49 -10.38 50 -10.04
 ABUNDANCE CHANGE 51 -11.04 52  -9.80 53 -10.53 54  -9.87 55 -10.91 56  -9.91
 ABUNDANCE CHANGE 57 -10.87 58 -10.46 59 -11.33 60 -10.54 61 -20.00 62 -11.03
 ABUNDANCE CHANGE 63 -11.53 64 -10.92 65 -11.69 66 -10.90 67 -11.78 68 -11.11
 ABUNDANCE CHANGE 69 -12.04 70 -10.96 71 -11.98 72 -11.16 73 -12.17 74 -10.93
 ABUNDANCE CHANGE 75 -11.76 76 -10.59 77 -10.69 78 -10.24 79 -11.03 80 -10.91
 ABUNDANCE CHANGE 81 -11.14 82 -10.09 83 -11.33 84 -20.00 85 -20.00 86 -20.00
 ABUNDANCE CHANGE 87 -20.00 88 -20.00 89 -20.00 90 -11.95 91 -20.00 92 -12.54
 ABUNDANCE CHANGE 93 -20.00 94 -20.00 95 -20.00 96 -20.00 97 -20.00 98 -20.00
 ABUNDANCE CHANGE 99 -20.00
READ DECK6 72 RHOX,T,P,XNE,ABROSS,ACCRAD,VTURB, FLXCNV,VCONV,VELSND
 3.62623992E-03   2084.1 1.147E-01 2.194E+05 3.677E-05 9.312E-04 2.000E+05 0.000E+00 0.000E+00 5.463E+05
 4.75773620E-03   2098.1 1.504E-01 2.849E+05 4.184E-05 9.265E-04 2.000E+05 0.000E+00 0.000E+00 5.118E+05
 6.08574047E-03   2110.2 1.924E-01 3.606E+05 4.748E-05 9.240E-04 2.000E+05 0.000E+00 0.000E+00 4.867E+05
 7.66924805E-03   2122.9 2.425E-01 4.511E+05 5.241E-05 9.180E-04 2.000E+05 0.000E+00 0.000E+00 4.689E+05
 9.60930050E-03   2136.9 3.039E-01 5.628E+05 5.632E-05 9.060E-04 2.000E+05 0.000E+00 0.000E+00 4.562E+05
 1.19970276E-02   2149.3 3.794E-01 6.977E+05 6.149E-05 8.959E-04 2.000E+05 0.000E+00 0.000E+00 4.454E+05
 1.49288163E-02   2163.0 4.721E-01 8.642E+05 6.614E-05 8.803E-04 2.000E+05 0.000E+00 0.000E+00 4.376E+05
 1.86232333E-02   2179.2 5.889E-01 1.078E+06 6.926E-05 8.552E-04 2.000E+05 0.000E+00 0.000E+00 4.324E+05
 2.33026736E-02   2195.3 7.369E-01 1.347E+06 7.329E-05 8.267E-04 2.000E+05 0.000E+00 0.000E+00 4.282E+05
 2.91692052E-02   2210.8 9.224E-01 1.681E+06 7.834E-05 7.970E-04 2.000E+05 0.000E+00 0.000E+00 4.247E+05
 3.64720091E-02   2225.5 1.153E+00 2.092E+06 8.395E-05 7.688E-04 2.000E+05 0.000E+00 0.000E+00 4.219E+05
 4.55686655E-02   2240.7 1.441E+00 2.604E+06 8.965E-05 7.397E-04 2.000E+05 0.000E+00 0.000E+00 4.200E+05
 5.70308216E-02   2258.1 1.803E+00 3.257E+06 9.394E-05 7.045E-04 2.000E+05 0.000E+00 0.000E+00 4.192E+05
 7.18285359E-02   2278.7 2.271E+00 4.117E+06 9.615E-05 6.605E-04 2.000E+05 0.000E+00 0.000E+00 4.195E+05
 9.10379575E-02   2299.7 2.879E+00 5.234E+06 9.916E-05 6.163E-04 2.000E+05 0.000E+00 0.000E+00 4.201E+05
 1.15298632E-01   2316.3 3.646E+00 6.598E+06 1.070E-04 5.901E-04 2.000E+05 0.000E+00 0.000E+00 4.197E+05
 1.45191687E-01   2332.2 4.591E+00 8.264E+06 1.159E-04 5.714E-04 2.000E+05 0.000E+00 0.000E+00 4.195E+05
 1.82139814E-01   2349.2 5.760E+00 1.033E+07 1.244E-04 5.533E-04 2.000E+05 0.000E+00 0.000E+00 4.198E+05
 2.28299826E-01   2367.9 7.219E+00 1.294E+07 1.320E-04 5.329E-04 2.000E+05 0.000E+00 0.000E+00 4.206E+05
 2.87021488E-01   2389.7 9.076E+00 1.633E+07 1.373E-04 5.036E-04 2.000E+05 0.000E+00 0.000E+00 4.221E+05
 3.60630478E-01   2406.6 1.140E+01 2.042E+07 1.501E-04 4.963E-04 2.000E+05 0.000E+00 0.000E+00 4.226E+05
 4.48266055E-01   2418.2 1.418E+01 2.510E+07 1.709E-04 5.148E-04 2.000E+05 0.000E+00 0.000E+00 4.220E+05
 5.51155812E-01   2429.7 1.743E+01 3.054E+07 1.934E-04 5.380E-04 2.000E+05 0.000E+00 0.000E+00 4.216E+05
 6.72739673E-01   2441.4 2.127E+01 3.694E+07 2.176E-04 5.636E-04 2.000E+05 0.000E+00 0.000E+00 4.213E+05
 8.17386013E-01   2454.0 2.585E+01 4.457E+07 2.427E-04 5.881E-04 2.000E+05 0.000E+00 0.000E+00 4.213E+05
 9.93274397E-01   2469.9 3.141E+01 5.403E+07 2.630E-04 5.944E-04 2.000E+05 0.000E+00 0.000E+00 4.221E+05
 1.20311303E+00   2477.6 3.805E+01 6.452E+07 3.022E-04 6.479E-04 2.000E+05 0.000E+00 0.000E+00 4.210E+05
 1.44898504E+00   2487.6 4.582E+01 7.692E+07 3.399E-04 6.939E-04 2.000E+05 0.000E+00 0.000E+00 4.205E+05
 1.74284854E+00   2500.2 5.511E+01 9.195E+07 3.767E-04 7.311E-04 2.000E+05 0.000E+00 0.000E+00 4.206E+05
 2.09903146E+00   2515.0 6.638E+01 1.104E+08 4.130E-04 7.601E-04 2.000E+05 0.000E+00 0.000E+00 4.211E+05
 2.52639746E+00   2525.8 7.989E+01 1.317E+08 4.647E-04 8.191E-04 2.000E+05 0.000E+00 0.000E+00 4.207E+05
 3.04793175E+00   2543.3 9.638E+01 1.589E+08 4.930E-04 8.207E-04 2.000E+05 0.000E+00 0.000E+00 4.217E+05
 3.70451444E+00   2559.3 1.171E+02 1.925E+08 5.214E-04 8.184E-04 2.000E+05 0.000E+00 0.000E+00 4.222E+05
 4.53996222E+00   2579.4 1.436E+02 2.362E+08 5.425E-04 7.947E-04 2.000E+05 0.000E+00 0.000E+00 4.235E+05
 5.60962543E+00   2603.7 1.774E+02 2.936E+08 5.658E-04 7.661E-04 2.000E+05 0.000E+00 0.000E+00 4.255E+05
 6.97857272E+00   2632.9 2.207E+02 3.694E+08 5.897E-04 7.292E-04 2.000E+05 0.000E+00 0.000E+00 4.284E+05
 8.71077172E+00   2657.4 2.755E+02 4.631E+08 6.281E-04 7.180E-04 2.000E+05 0.000E+00 0.000E+00 4.302E+05
 1.09270172E+01   2688.6 3.455E+02 5.882E+08 6.411E-04 6.583E-04 2.000E+05 0.000E+00 0.000E+00 4.332E+05
 1.38070544E+01   2720.7 4.366E+02 7.526E+08 6.620E-04 6.060E-04 2.000E+05 0.000E+00 0.000E+00 4.363E+05
 1.74955463E+01   2757.4 5.533E+02 9.719E+08 6.941E-04 5.621E-04 2.000E+05 0.000E+00 0.000E+00 4.402E+05
 2.21660570E+01   2792.4 7.009E+02 1.252E+09 7.338E-04 5.297E-04 2.000E+05 0.000E+00 0.000E+00 4.436E+05
 2.80638216E+01   2832.8 8.874E+02 1.626E+09 7.737E-04 4.893E-04 2.000E+05 0.000E+00 0.000E+00 4.480E+05
 3.55016653E+01   2874.6 1.123E+03 2.117E+09 8.204E-04 4.527E-04 2.000E+05 0.000E+00 0.000E+00 4.526E+05
 4.48424961E+01   2915.8 1.418E+03 2.754E+09 8.730E-04 4.265E-04 2.000E+05 0.000E+00 0.000E+00 4.570E+05
 5.64867978E+01   2958.9 1.786E+03 3.591E+09 9.385E-04 4.102E-04 2.000E+05 0.000E+00 0.000E+00 4.616E+05
 7.08144040E+01   3002.8 2.239E+03 4.678E+09 1.025E-03 4.074E-04 2.000E+05 0.000E+00 0.000E+00 4.664E+05
 8.82628923E+01   3047.7 2.791E+03 6.088E+09 1.123E-03 4.142E-04 2.000E+05 0.000E+00 0.000E+00 4.713E+05
 1.09577287E+02   3094.1 3.465E+03 7.934E+09 1.221E-03 4.259E-04 2.000E+05 0.000E+00 0.000E+00 4.765E+05
 1.35732948E+02   3143.8 4.292E+03 1.041E+10 1.328E-03 4.486E-04 2.000E+05 0.000E+00 0.000E+00 4.821E+05
 1.67765960E+02   3200.4 5.305E+03 1.388E+10 1.447E-03 4.890E-04 2.000E+05 0.000E+00 0.000E+00 4.890E+05
 2.07069523E+02   3268.1 6.548E+03 1.902E+10 1.571E-03 5.498E-04 2.000E+05 0.000E+00 0.000E+00 4.979E+05
 2.55003876E+02   3354.4 8.064E+03 2.727E+10 1.732E-03 6.504E-04 2.000E+05 4.428E-06 3.429E+03 5.102E+05
 3.11588048E+02   3465.4 9.853E+03 4.131E+10 2.012E-03 8.291E-04 2.000E+05 2.440E-05 6.060E+03 5.273E+05
 3.75227601E+02   3613.7 1.187E+04 6.668E+10 2.444E-03 1.021E-03 2.000E+05 1.552E-05 5.372E+03 5.525E+05
 4.35980513E+02   3766.8 1.379E+04 1.018E+11 3.837E-03 1.461E-03 2.000E+05 2.190E-05 6.248E+03 5.802E+05
 4.89736781E+02   3938.5 1.549E+04 1.477E+11 5.468E-03 1.890E-03 2.000E+05 2.464E-05 6.770E+03 6.119E+05
 5.43158072E+02   4106.2 1.718E+04 1.978E+11 7.007E-03 2.241E-03 2.000E+05 2.628E-05 7.072E+03 6.401E+05
 6.00223019E+02   4297.6 1.898E+04 2.578E+11 8.581E-03 2.582E-03 2.000E+05 3.378E-05 7.790E+03 6.682E+05
 6.62620569E+02   4499.3 2.095E+04 3.364E+11 1.049E-02 3.041E-03 2.000E+05 8.165E-05 1.046E+04 6.929E+05
 7.28129915E+02   4729.6 2.302E+04 4.994E+11 1.409E-02 3.949E-03 2.000E+05 8.081E-04 2.239E+04 7.167E+05
 7.87594955E+02   4981.6 2.490E+04 9.050E+11 2.270E-02 6.143E-03 2.000E+05 1.397E-02 5.757E+04 7.391E+05
 8.33351246E+02   5259.3 2.635E+04 1.889E+12 4.140E-02 1.046E-02 2.000E+05 6.798E-02 9.728E+04 7.606E+05
 8.66728829E+02   5536.7 2.741E+04 3.905E+12 7.477E-02 1.596E-02 2.000E+05 2.191E-01 1.444E+05 7.795E+05
 8.92326991E+02   5790.1 2.822E+04 7.301E+12 1.247E-01 2.010E-02 2.000E+05 4.314E-01 1.831E+05 7.945E+05
 9.13851817E+02   6005.8 2.890E+04 1.204E+13 1.886E-01 2.158E-02 2.000E+05 6.023E-01 2.048E+05 8.054E+05
 9.33571005E+02   6192.3 2.952E+04 1.811E+13 2.655E-01 2.206E-02 2.000E+05 7.090E-01 2.147E+05 8.134E+05
 9.52684668E+02   6360.5 3.012E+04 2.572E+13 3.581E-01 2.215E-02 2.000E+05 7.828E-01 2.201E+05 8.183E+05
 9.71878837E+02   6517.6 3.073E+04 3.518E+13 4.694E-01 2.232E-02 2.000E+05 8.339E-01 2.237E+05 8.237E+05
 9.91541351E+02   6670.4 3.135E+04 4.708E+13 6.068E-01 2.226E-02 2.000E+05 8.698E-01 2.236E+05 8.271E+05
 1.01204871E+03   6814.7 3.200E+04 6.136E+13 7.699E-01 2.222E-02 2.000E+05 8.995E-01 2.250E+05 8.295E+05
 1.03355537E+03   6963.0 3.268E+04 7.969E+13 9.780E-01 2.207E-02 2.000E+05 9.200E-01 2.224E+05 8.313E+05
 1.05635130E+03   7100.1 3.340E+04 1.007E+14 1.216E+00 2.337E-02 2.000E+05 9.324E-01 2.208E+05 8.327E+05
PRADK 2.0053E-01
BEGIN                    ITERATION  15 COMPLETED
"""




@patch("builtins.open", new_callable=mock_open, read_data=grid_text)
def test_split_models_to_strings_and_read_teff_and_logg(mock_file):
    g = models_grid.Grid("grid_path")
    g._split_models()

    assert g._models[0][0] == 3500 
    assert g._models[0][1] == 0.0

    assert g._models[3][1] == 1.5


@patch("builtins.open", new_callable=mock_open, read_data=grid_text)
def test_return_best_model(mock_file):
    
    # Mock parameters object
    parameters = MagicMock()
    parameters.teff = 3600.
    parameters.logg = 1.15

    nearest_model = model.Model()
    

    g = models_grid.Grid("path_to_grid")
    model_string = g.get_best_model(parameters)
    nearest_model.model_from_string(model_string)
    
    assert nearest_model.teff == 3500.
    assert nearest_model.logg == 1.0

def main():
    pass

if __name__ == '__main__':
    main()